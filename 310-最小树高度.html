<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>

        var findMinHeightTrees1 = function (n, edges) {
            if (n === 1) return [0]
            const map = new Map()
            let minHeight = Infinity
            let res = []
            // 建立邻接表 (双向)
            for (const [node1, node2] of edges) {
                if (!map.has(node1)) {
                    map.set(node1, [node2])
                } else {
                    map.get(node1).push(node2)
                }

                if (!map.has(node2)) {
                    map.set(node2, [node1])
                } else {
                    map.get(node2).push(node1)
                }
            }
            for (let i = 0; i < n; i++) {
                const height = bfs(i, n, map)
                if (height === minHeight) {
                    res.push(i)
                } else if (height < minHeight) {
                    res = [i]
                    minHeight = height
                }
            }
            return res
        };

        const bfs = (node, n, map) => {
            let height = 0
            const visited = new Array(n).fill(false)
            const queue = [node]
            visited[node] = true
            let current, preLength = queue.length, index = 0, round = preLength
            while (index < queue.length) {
                current = queue[index]
                for (let i = 0; i < round; i++) {
                    for (const next of map.get(current)) {
                        if (!visited[next]) {
                            queue.push(next)
                            visited[next] = true
                        }
                    }
                    index++
                }
                if (preLength !== queue.length) {
                    height++
                    preLength = queue.length
                    round = queue.length - preLength
                }
            }
            return height
        }

        var findMinHeightTrees2 = function (n, edges) {
            // 建立邻接表
            const map = new Map()
            for (const [one, two] of edges) {
                if (!map.get(one)) {
                    const set = new Set()
                    map.set(one, set)
                }
                if (!map.get(two)) {
                    const set = new Set()
                    map.set(two, set)
                }
                map.get(one).add(two)
                map.get(two).add(one)
            }
            // 初始化queue
            const queue = [], res = []
            let index = 0
            for (let i = 0; i < n; i++) {
                if (map.get(i).size === 1) {
                    queue.push(i)
                    res.push(i)
                }
            }
            // debugger
            let current, next, preLength = queue.length, count = 0
            while (index < queue.length) {
                res.length = 0
                for (let j = 0; j < preLength; j++) {
                    current = queue[index]
                    next = [...map.get(current)][0]
                    map.get(next).delete(current)
                    if (map.get(next).size === 1) {
                        queue.push(next)
                        res.push(next)
                        count++
                        if (queue.length === n) return res
                    }
                    index++
                }
                preLength = count
                count = 0
            }
            return res
        };

        var findMinHeightTrees3 = function (n, edges) {
            if (edges.length === 1) return [0]
            let res = []
            // 初始化邻接表
            const mapArr = new Array(n).fill(0).map(() => new Set())
            debugger
            for (const [one, two] of edges) {
                mapArr[one].add(two)
                mapArr[two].add(one)
            }
            debugger
            // 把所有叶子节点添加到res队列中
            for (let i = 0; i < n; i++) {
                if (mapArr[i].size === 1) res.push(i)
            }
            debugger
            while (n > 2) {
                n -= res.length
                const temp = []
                for (const ele of res) {
                    mapArr[[...mapArr[ele]][0]].delete(ele)
                    if (mapArr[sub].size === 1) {
                        temp.push(sub)
                    }
                }
                res = temp
            }
            return res
        };


        var findMinHeightTrees = function (n, edges) {

            // 建立邻接表
            const mapArr = new Array(n).fill(0).map(() => new Set())
            for (const [node1, node2] of edges) {
                mapArr[node1].add(node2)
                mapArr[node2].add(node1)
            }
            console.log(123);
            debugger
            // 初始化队列, 将所有叶子节点加入到队列中
            const queue = []
            for (let i = 0; i < n; i++) {
                if (mapArr[i].size === 1)
                    queue.push(i)
            }
            let res
            let temp, pre
            while (n > 2) {
                n -= queue.length
                res = []
                while (queue.length) {
                    temp = queue.pop()
                    pre = [...mapArr[temp]][0]
                    mapArr[pre].delete(temp)
                    if (mapArr[pre].size === 1) {
                        res.push(pre)
                    }
                }
                queue = [...res]
            }
            return res
        };

        // findMinHeightTrees(6, [[3, 0], [3, 1], [3, 2], [3, 4], [5, 4]])
        // findMinHeightTrees(2, [[0, 1]])
        // console.log(findMinHeightTrees(17, [[0, 1], [0, 2], [1, 3], [3, 4], [0, 5], [0, 6], [4, 7], [3, 8], [6, 9], [1, 10], [10, 11], [9, 12], [2, 13], [10, 14], [12, 15], [4, 16]]));
        console.log(findMinHeightTrees(4, [[1, 0], [1, 2], [1, 3]])); 
    </script>
</body>

</html>