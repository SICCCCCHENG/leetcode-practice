<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>

        var maximalSquare1 = function (matrix) {
            const m = matrix.length
            const n = matrix[0].length
            let ans = 0
            debugger
            for (let i = 0; i < m; i++) {
                for (let j = 0; j < n; j++) {
                    if (matrix[i][j] === '0') {
                        matrix[i][j] = {
                            u: 0,
                            l: 0,
                            pre: 0,
                        }
                    } else {
                        matrix[i][j] = {
                            u: (i - 1 < 0 ? 1 : (1 + matrix[i - 1][j].u)),
                            l: (j - 1 < 0 ? 1 : (1 + matrix[i][j - 1].l)),
                            pre: (i - 1 < 0 || j - 1 < 0) ? 1 :
                                (matrix[i - 1][j].u >= matrix[i - 1][j - 1] && matrix[i][j - 1].l >= matrix[i - 1][j - 1]) ?
                                    matrix[i - 1][j - 1] + 1 : Math.min(matrix[i - 1][j].u, matrix[i][j - 1].l) + 1,
                        }
                        ans = Math.max(ans, matrix[i][j].pre)
                    }
                }
            }
            return ans * ans
        };

        var maximalSquare = function (matrix) {
            const row = matrix.length
            const col = matrix[0].length
            const dp = new Array(row).fill(0).map(() => new Array(col).fill({}))
            let max = 0
            debugger
            for (let i = 0; i < row; i++) {
                for (let j = 0; j < col; j++) {
                    if (matrix[i][j] === '1') {
                        dp[i][j] = 1 + ((i - 1 < 0 || j - 1 < 0) ? 0 : Math.min(dp[i - 1][j - 1], dp[i][j - 1], dp[i - 1][j]))
                    } else {
                        dp[i][j] = 0
                    }
                    max = Math.max(max, dp[i][j])
                }
            }
            return max * max
        };

        maximalSquare([["1", "0", "1", "0", "0"], ["1", "0", "1", "1", "1"], ["1", "1", "1", "1", "1"], ["1", "0", "0", "1", "0"]])

    </script>
</body>

</html>