<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>

        var maxChunksToSorted2 = function (arr) {
            const length = arr.length
            const copied = [...arr]
            copied.sort((a, b) => a - b)
            let map = {}
            let start = 0, ans = 0
            for (let i = 0; i < length; i++) {
                if (!map[arr[i]]) {
                    map[arr[i]] = 1
                } else {
                    map[arr[i]]++
                }
                if (checkCanReach(copied, map, start, i)) {
                    ans++
                    map = {}
                    start = i + 1
                }
            }
            return ans
        };

        const checkCanReach = (arr, map, start, dest) => {
            const copiedMap = { ...map }
            for (let i = start; i <= dest; i++) {
                if (!copiedMap[arr[i]]) {
                    return false
                } else {
                    copiedMap[arr[i]]--
                }
            }
            return true
        }

        var maxChunksToSorted = function (arr) {
            const length = arr.length
            const sorted = [...arr].sort((a, b) => a - b)
            const mapSorted = {}
            let diff = 0, ans = 0
            debugger
            for (let i = 0; i < length; i++) {
                if (!mapSorted[sorted[i]]) {
                    mapSorted[sorted[i]] = 1
                    diff++
                } else {
                    if (mapSorted[sorted[i]] === -1) {
                        diff--
                    } else if (mapSorted[sorted[i]] === 0) {
                        diff++
                    }
                    mapSorted[sorted[i]]++
                }
                if (!mapSorted[arr[i]]) {
                    diff++
                    mapSorted[arr[i]] = -1
                } else {
                    if (mapSorted[arr[i]] === 1) {
                        diff--
                    } else if (mapSorted[arr[i]] === 0) {
                        diff++
                    }
                    mapSorted[arr[i]]--
                }
                if (diff === 0) ans++
            }
            return ans
        };

        // console.log(maxChunksToSorted([1205, 1720, 1104, 676, 799, 270, 1075, 745, 1938, 1810, 3496, 2719, 3570, 3176, 2872, 3566, 2777, 3392, 2857, 3828, 4974, 4980, 5756, 5989, 4514, 5433, 4048, 5734, 5991, 4084, 6924, 7891, 6957, 6633, 7325, 7140, 6053, 6017, 7321, 7675, 9318, 8792, 9576, 9658, 8226, 9051, 8062, 9377, 9705, 8115, 10170, 11848, 11636, 10084, 10062, 10318, 11043, 10986, 10079, 10893, 12491, 12264, 13829, 12463, 13707, 13200, 12781, 13028, 13936, 12737, 14427, 15529, 14252, 15093, 15733, 14464, 15193, 15094, 14471, 14028, 17875, 16548, 17939, 16872, 17259, 16961, 16369, 16952, 16427, 17375, 19211, 18890, 18225, 19256, 18126, 19314, 18354, 19033, 19069, 18374, 21786, 20534, 20098, 20570, 20978, 21145, 21030, 20249, 20963, 20733, 22641, 23467, 22896, 22973, 22915, 22603, 23761, 23036, 22076, 23035, 24364, 24217, 24938, 25576, 25517, 25700, 25291, 25941, 25432, 24122, 26853, 26066, 27014, 27397, 26025, 26603, 26918, 27294, 27255, 27026, 29937, 28470, 29569, 28124, 29390, 28394, 29485, 29791, 29794, 29921, 30040, 30496, 30951, 31297, 30102, 31099, 30881, 31408, 31701, 30677, 32256, 33823, 33001, 32482, 32903, 32345, 33647, 33958, 33899, 33721, 34821, 34957, 34781, 35917, 35129, 34333, 34156, 34715, 34796, 34642, 36940, 37327, 37748, 36485, 36488, 35982, 36764, 37075, 37499, 36339, 39234, 39537, 39103, 39656, 39308, 39762, 38669, 38733, 38791, 38397, 41083, 40187, 41128, 40405, 41406, 41367, 40630, 40776, 40631, 41284, 43492, 42767, 42283, 42630, 43897, 42744, 43875, 42367, 43203, 43141, 44803, 45201, 45431, 45283, 45572, 45826, 45074, 45458, 45366, 45818, 47786, 47123, 46319, 46850, 46321, 47102, 47748, 47889, 46882, 46277, 49344, 49381, 49026, 48875, 48736, 48555, 49557, 48259, 49127, 49295, 51872, 51578, 51274, 50985, 50976, 50590, 51055, 51420, 49989, 50249, 52652, 52108, 53481, 52289, 53257, 53428, 52690, 53173, 53555, 52857, 55613, 55300, 54611, 54739, 54071, 54786, 54373, 54689, 54144, 55958, 57862, 57712, 57646, 56379, 57271, 57740, 57076, 57047, 56235, 57934, 58748, 58619, 59423, 58380, 59837, 59955, 57993, 58978, 57990, 59804, 60825, 60899, 60903, 61917, 61955, 60447, 60316, 60479, 60159, 60962, 62212, 63618, 62198, 63130, 63557, 62710, 63259, 63254, 62267, 62496, 64192, 64685, 64456, 64759, 65908, 64637, 65699, 65260, 65694, 65305, 66120, 66304, 67016, 67763, 66178, 67604, 67558, 66150, 66298, 66170, 69719, 69584, 68311, 69124, 69818, 69467, 69236, 69098, 68150, 69453, 70798, 71711, 70360, 71920, 71675, 71079, 69986, 71510, 71784, 71091, 73143, 72800, 72462, 72884, 71969, 72328, 73921, 73045, 72849, 73127, 75636, 74836, 75444, 75356, 75244, 75902, 74215, 75480, 75295, 74185, 76818, 76224, 76804, 76825, 77284, 77620, 76521, 75993, 77093, 76104, 79276, 79256, 79358, 79890, 78637, 79715, 79874, 78778, 78022, 78224, 80414, 80395, 81621, 81650, 81568, 80429, 81612, 81848, 81377, 81758, 83363, 82733, 82163, 82671, 83072, 82316, 83634, 82560, 83851, 82301, 84457, 84855, 85877, 84210, 84109, 84000, 84316, 84038, 85466, 85478, 87885, 86427, 87114, 86847, 87842, 86343, 86203, 86074, 87703, 86517, 89808, 89135, 88805, 89539, 89713, 89091, 88884, 88103, 88622, 88735, 91381, 91587, 90792, 91080, 90231, 91702, 90123, 91087, 91492, 91375, 93920, 93556, 93395, 92059, 92740, 93830, 93255, 92400, 93513, 93157, 93991, 95323, 95053, 94678, 95020, 95475, 94750, 94053, 93999, 95527, 97289, 97046, 96000, 96851, 96081, 96128, 97291, 96636, 96041, 96733, 99648, 98175, 99476, 98610, 98558, 97984, 99054, 98447, 99447, 99771, 100746, 101445, 100237, 100577, 100261, 100849, 101889, 100532, 100739, 101605, 102151, 103422, 102758, 102574, 102271, 103713, 102531, 102293, 102588, 102492, 104032, 105801, 104852, 104536, 105735, 105808, 104402, 105660, 104426, 105075, 107392, 107137, 106490, 106040, 107617, 106441, 107414, 106718, 107377, 107787, 109116, 108141, 108860, 108100, 109472, 108609, 109921, 109533, 108736, 109469, 111839, 111064, 110221, 110233, 110293, 110406, 110377, 110084, 110820, 111059, 112001, 113407, 113081, 111996, 113546, 113278, 112033, 112141, 113723, 112190, 115590, 115094, 115282, 115221, 114264, 115878, 114238, 115654, 114244, 114087, 116382, 116909, 116194, 117582, 116230, 116726, 116522, 117924, 117863, 116527, 118054, 119372, 119879, 117977, 118740, 118068, 119862, 118247, 118783, 119638, 121909, 121642, 120324, 120640, 120449, 121212, 120965, 121317, 120583, 121181, 122621, 122381, 123462, 122627, 122842, 122743, 123712, 121941, 122822, 123064, 124442, 124902, 125005, 124737, 124817, 125898, 125030, 125413, 124398, 124396, 126419, 127065, 125981, 127358, 127925, 125939, 127151, 126272, 127799, 126866, 128366, 129691, 128144, 128875, 128209, 128689, 128407, 129027, 128294, 129765, 130599, 130327, 131154, 131073, 130953, 130516, 130344, 131077, 131507, 130548, 132594, 132698, 132874, 132216, 133783, 133827, 133926, 132375, 132393, 133749, 134007, 134149, 134240, 135379, 135294, 135891, 135506, 134589, 134673, 135209, 137838, 136216, 136909, 136540, 136214, 136481, 137361, 137060, 137099, 136093, 138618, 139615, 138409, 138362, 138404, 139279, 139499, 137963, 139262, 139044, 140204, 141074, 140338, 141517, 140805, 141803, 141176, 140818, 141869, 140929, 142149, 143827, 143581, 142126, 143786, 143183, 143688, 142950, 142684, 143324, 145529, 144550, 144263, 144719, 144164, 144250, 144199, 144497, 145520, 145065, 147322, 147181, 147218, 147112, 147207, 147512, 145928, 146624, 146932, 147664, 147939, 147975, 148186, 148715, 149278, 148601, 148352, 148803, 149756, 149326, 150029, 150615, 151026, 151122, 151019, 151245, 150635, 151547, 151766, 149942, 151927, 153676, 152924, 152740, 152329, 152950, 153350, 153056, 153447, 153088, 155118, 154015, 154919, 155368, 154351, 154524, 155008, 155289, 154665, 154948, 157496, 157476, 157043, 156119, 157694, 157916, 157342, 157591, 157371, 157424, 158090, 158595, 158143, 158762, 159764, 158400, 159188, 159600, 159919, 159041, 160026, 160823, 161152, 161263, 160708, 160078, 160089, 160248, 160373, 161323, 163238, 162784, 162576, 162457, 162916, 162344, 162304, 162908, 162792, 161982, 165893, 165520, 163955, 165568, 164790, 164536, 165804, 163959, 164492, 164897, 167575, 167444, 166610, 166865, 167530, 167084, 166837, 166705, 166003, 167090, 169036, 168354, 169051, 169292, 169617, 169697, 169586, 168993, 168413, 168283, 170490, 170234, 171188, 170203, 170095, 171162, 171084, 169970, 171774, 169995, 173436, 173449, 173758, 172280, 173378, 173566, 172638, 173589, 173408, 173459, 175688, 175337, 174413, 175305, 175277, 174624, 174640, 175095, 175249, 175041, 176138, 176051, 177447, 176424, 176252, 176525, 176833, 176717, 177110, 175934, 179583, 178217, 179442, 179793, 179873, 179433, 178225, 179148, 178651, 179822, 181586, 180775, 180761, 181855, 181381, 180728, 181607, 181268, 181608, 181460, 182177, 182553, 183141, 182573, 183598, 183224, 183600, 183798, 181964, 182016, 184709, 184735, 184792, 184810, 185239, 185253, 184723, 184516, 185090, 185866, 187163, 187084, 187116, 187777, 186078, 187562, 186823, 186453, 186993, 186481, 189590, 188319, 188907, 189589, 189879, 188044, 189684, 189108, 189326, 189545, 191527, 191421, 190631, 190530, 191635, 191614, 190863, 191824, 191574, 190227, 192538, 193492, 192936, 192669, 193215, 192998, 192416, 192353, 193236, 193446, 195865, 195057, 195097, 194476, 195398, 194578, 194285, 194704, 194341, 193977, 196980, 195921, 196858, 197437, 196799, 196731, 197330, 196233, 196686, 197396, 199607, 198736, 199463, 198615, 198756, 198552, 198802, 199141, 198084, 199501, 200321, 201468, 199915, 201694, 200122, 200894, 201167, 200640, 200814, 199958, 201910, 202335, 203189, 203220, 202975, 202354, 202857, 203730, 202090, 202150, 203925, 204218, 205382, 205613, 204687, 204357, 205137, 204733, 204929, 204489, 206974, 207094, 207032, 206300, 207584, 206163, 206653, 206927, 206189, 206715, 209708, 208998, 209121, 208292, 208348, 209774, 209794, 209310, 208198, 208773, 211221, 210167, 210426, 211248, 210990, 210968, 211529, 211811, 210359, 211037, 212705, 212908, 212019, 212202, 213066, 213536, 212815, 213788, 212443, 213440, 215349, 215603, 215470, 214877, 214061, 215132, 214874, 215562, 214441, 215738, 217700, 216459, 216987, 216530, 217398, 217048, 216988, 216532, 216611, 216127, 218356, 219878, 219197, 218769, 218775, 218285, 218448, 219081, 219743, 218209, 219921, 221317, 221661, 220331, 221859, 220991, 220464, 221212, 220362, 220516, 223887, 222575, 223740, 222999, 222162, 222068, 222656, 223671, 222724, 222734, 224553, 224823, 225505, 223993, 225792, 224966, 225718, 225845, 225543, 225001, 227456, 227808, 226749, 227683, 227664, 227233, 227300, 226813, 226366, 226354, 228245, 229834, 227930, 228938, 229599, 229299, 228465, 229711, 229529, 229526, 230215, 230942, 230462, 231746, 231220, 231147, 230942, 230604, 231127, 231369, 233865, 232144, 233777, 232521, 232715, 232001, 233308, 233742, 232226, 231923, 233944, 234710, 234309, 235368, 234489, 234178, 234623, 234855, 235714, 235869, 236579, 237819, 237529, 236141, 237280, 236228, 237857, 236599, 237655, 237844, 238135, 238641, 238125, 239657, 238192, 238526, 239104, 239725, 239089, 237962, 241412, 241005, 240753, 240779, 240350, 240912, 240000, 241473, 241591, 240602, 242050, 242175, 242647, 243791, 243709, 242609, 243361, 242015, 243172, 242794, 245402, 243882, 245592, 245046, 243892, 244744, 244441, 245669, 245749, 245518, 247817, 246119, 247498, 246414, 246388, 245947, 246009, 246644, 247588, 245941, 248490, 248094, 249426, 249176, 248568, 248234, 249507, 248767, 248937, 249239, 251352, 251788, 249939, 251871, 250880, 250701, 251437, 249960, 251377, 250309, 252748, 253699, 253199, 252611, 252186, 253364, 253165, 251977, 253660, 252661, 254312, 254953, 254404, 254025, 255551, 255168, 255184, 255351, 254076, 255572, 256483, 255950, 255918, 257269, 256669, 257299, 257685, 257413, 257264, 257718, 258363, 258123, 259122, 258743, 258216, 258862, 259557, 259135, 258131, 259258, 260605, 260927, 261355, 260451, 261481, 261824, 260118, 260820, 260822, 260902, 262058, 263545, 263582, 263256, 262160, 263242, 263840, 263054, 262312, 262665, 263926, 265714, 265716, 264960, 264075, 264772, 263983, 265512, 265389, 265141, 267275, 267357, 267546, 266003, 266977, 266005, 267386, 267612, 266126, 267415, 269087, 268512, 269509, 268545, 268291, 269650, 268262, 268803, 269455, 267907, 271692, 271572, 270746, 270996, 271772, 271066, 270517, 271116, 270533, 270540, 272373, 272941, 272456, 273085, 272548, 272320, 273127, 272778, 272931, 273395, 274159, 274476, 275403, 275440, 274188, 273967, 274731, 275174, 274810, 274157, 276010, 276940, 277085, 276193, 276208, 277374, 277629, 276749, 277250, 276756, 279520, 279558, 279076, 279621, 278579, 278535, 279836, 278097, 278037, 278538, 279992, 280888, 281217, 280806, 281239, 281064, 281090, 279881, 280815, 281415, 283664, 283000, 282476, 283080, 282633, 282927, 283361, 282948, 282841, 282078, 283961, 284537, 284996, 285520, 283886, 284701, 285551, 284144, 284439, 284193, 286657, 287205, 287616, 286687, 286335, 286537, 287040, 286116, 286389, 286093, 288032, 288608, 288721, 289076, 289506, 288477, 288579, 289808, 288991, 289083, 291346, 289999, 289951, 290744, 291754, 291636, 290194, 289886, 290821, 290615, 292204, 293080, 292572, 292925, 291884, 292019, 293019, 293348, 293047, 292132, 295050, 295232, 295676, 295204, 293980, 294767, 295320, 294116, 294646, 295342, 297380, 296036, 297548, 297330, 296518, 297309, 297433, 297064, 296067, 296191, 299812, 299297, 298793, 299798, 298900, 297995, 297969, 297960, 299106, 299664, 300678, 300989, 300390, 300889, 301771, 301592, 300205, 300959, 300417, 300576, 303283, 303463, 303462, 303395, 303316, 301946, 303709, 302657, 302324, 302335, 304402, 304496, 305436, 305281, 305043, 305404, 304730, 305767, 304830, 305545, 306505, 305963, 307734, 306871, 307146, 306215, 306431, 305885, 306033, 306052, 307856, 309131, 308736, 308754, 308314, 308421, 308001, 309146, 308212, 309523, 310870, 311121, 311724, 310380, 311143, 311506, 311656, 311804, 310722, 310305, 313499, 312669, 313137, 311943, 313581, 312297, 312102, 313413, 313843, 313458, 314082, 315134, 313905, 314305, 314775, 314848, 314728, 315607, 314063, 314312, 317144, 316388, 317107, 316059, 316278, 317616, 316620, 316353, 316483, 316195, 319436, 318259, 319412, 318833, 317916, 318616, 318864, 319749, 318199, 318783, 320979, 320770, 320980, 320849, 321721, 321301, 320004, 321405, 319924, 321454, 322621, 323147, 323129, 323626, 323186, 323338, 322779, 322992, 322208, 321983, 325754, 325531, 324890, 323988, 324864, 325181, 325557, 324107, 324671, 323963, 326086, 327770, 327486, 326535, 327580, 327708, 326277, 326721, 325967, 327004, 327860, 329458, 329735, 327841, 328212, 327927, 329551, 329530, 329566, 329785, 331819, 331060, 330182, 331142, 331721, 331490, 330199, 330370, 330386, 331776, 333833, 333773, 333016, 332250, 332072, 332671, 333178, 332950, 332260, 332566, 333944, 334606, 334540, 335309, 333885, 334986, 335683, 335365, 333946, 335448, 337004, 336014, 336509, 337232, 337374, 336239, 337324, 337764, 336350, 336381, 337992, 339116, 338212, 339678, 338526, 339245, 338216, 338364, 337977, 338862, 340354, 340108, 340603, 341176, 340490, 341041, 340745, 340700, 341824, 340008, 343788, 343176, 342325, 343491, 342481, 343560, 343271, 342770, 341959, 342802, 345679, 344127, 345082, 345142, 344445, 344505, 344733, 344033, 344535, 345104, 346737, 346615, 346772, 346937, 347161, 347694, 347170, 346784, 346972, 346017, 348869, 349561, 349102, 349563, 349261, 349783, 349644, 348295, 348305, 347826, 350761, 351160, 350629, 350664, 350554, 350713, 349881, 351267, 351185, 350920, 352498, 352099, 352536, 351911, 352654, 353323, 353007, 351923, 352547, 353455, 354994, 354684, 354186, 355495, 354912, 353868, 355408, 355797, 355037, 355749, 357571, 356001, 356296, 357210, 357647, 356529, 357004, 356836, 357219, 356156, 358404, 357920, 357878, 358210, 359493, 359387, 359387, 357910, 359034, 359358, 360326, 361033, 360425, 360196, 359905, 360367, 359886, 359880, 361729, 361651, 362440, 362799, 362191, 363427, 363173, 362079, 362325, 362663, 363114, 362147, 365586, 365603, 365395, 364762, 364795, 364025, 363855, 364452, 363921, 363868, 367065, 366697, 367811, 366995, 367054, 367499, 365828, 366517, 367476, 366463, 368195, 369618, 368182, 368093, 369562, 369789, 367900, 368033, 368901, 367973, 370801, 370450, 371094, 370871, 371614, 370817, 371408, 371765, 371441, 371644, 373462, 373721, 371854, 373568, 372423, 372880, 372654, 373652, 373164, 372924, 375746, 374772, 375233, 375541, 375251, 375717, 374955, 375102, 373947, 375380, 375932, 377659, 377707, 377409, 376707, 375900, 377471, 376145, 376320, 376977, 379280, 377969, 379611, 378248, 379622, 378016, 379341, 379480, 378555, 378465, 380259, 381777, 380068, 381093, 380803, 381331, 379944, 380779, 380811, 380556, 383508, 382784, 382000, 383066, 383006, 383325, 383650, 382016, 383093, 381991, 385167, 384951, 385476, 385789, 385247, 385586, 384949, 384315, 384583, 385723, 386714, 386958, 386744, 386713, 387286, 386131, 387090, 387346, 386935, 386460, 388020, 389234, 389308, 388679, 389697, 388531, 388776, 389690, 387919, 389043, 390204, 390287, 391628, 390960, 390004, 390260, 391694, 391559, 391673, 390358, 393685, 393733, 393660, 391908, 392325, 393740, 392868, 392276, 391863, 393351, 394399, 395726, 394325, 395224, 394163, 394211, 395676, 395014, 394361, 395213, 396473, 396840, 395938, 396712, 397601, 396632, 396271, 397670, 395952, 396424, 399046, 398954, 398172, 399338, 399482, 398979, 399217, 398474, 398475, 398028]));
        // console.log(maxChunksToSorted([5, 4, 3, 2, 1]));
        console.log(maxChunksToSorted([2, 1, 3, 4, 4]));
    </script>
</body>

</html>